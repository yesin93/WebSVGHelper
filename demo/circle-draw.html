<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Circle draw</title>
    <link href="../css/shapesJS.css" rel="stylesheet" type="text/css"/>
    <script src="../libs/d3/d3.min.js"></script>
</head>
<body>

<div id="circle-container">
    <svg id="circle-svg" width="600" height="500"></svg>
</div>
<script>

    //properties for circle drawing
    var point1 = [];
    var point2 = [];
    var svgCanvas = d3.select("#circle-svg");
    var circle;

    svgCanvas.call(d3.drag().on("start", initialPlod)
        .on("drag", dragDraw)
        .on("end", stopRendering));

//    svgCanvas.on("mousedown", sizeCircle);

    function getRadius(cX, cY, perimeterX, perimeterY){
        /**
         * using circle equation
         *
         * r2 = (x2 - x1)^2 + (y2 - y1)^2
         */
       return Math.sqrt(Math.pow((perimeterX - cX), 2) + Math.pow((perimeterY - cY),2));
    }

    //initial marking of the circle on the canvas
    function initialPlod(){
        point1 = d3.mouse(this);
        circle = svgCanvas.append("circle")
            .attr("cx", point1[0])
            .attr("cy", point1[1])
            .attr("r", 0);

        circle2 = svgCanvas.append("circle")
            .attr("cx", point1[0])
            .attr("cy", point1[1])
            .attr("r", 0);
    }

    //drag point to adjust radius and render circle
    function dragDraw(){
        point2 = d3.mouse(this);
        circle = circle.attr("r", getRadius(point1[0], point1[1], point2[0], point2[1]));
//        return circle
    }

    function selectDrag(){
        var mousing = d3.mouse(this);
        var mousingX = mousing[0];
        var mousingY = mousing[1];
//        d3.select(this).attr("cx", mousingX).attr("cy",mousingY).attr("r", getRadius(cX, cY, mousingX, mousingY));
        d3.select(this).attr("cx", mousingX).attr("cy",mousingY);
    }

    function resizingCircle(){

    }

    function stopRendering(){
        svgCanvas.call(d3.drag().on("start", null)
            .on("drag", null)
            .on("end", null));
        circle.call(d3.drag().on("drag", selectDrag));

        circle.on("mouseover", highlight)
            .on("mouseout", unhighlight);

        function highlight(){
            d3.select(this).classed('circle-active', true);

//            d3.selectAll(this)
//                .transition()
//                .duration(500)  // Set how long it takes
//                .style("stroke-width", 5);
        }

        function unhighlight(){
            d3.select(this).classed('circle-active', false);
        }
    }

</script>
<!--<script>-->
    <!--//properties for circle drawing-->
    <!--var point1 = [];-->
    <!--var point2 = [];-->
    <!--var svgCanvas = d3.select("#circle-svg");-->
    <!--var container;-->
    <!--var circle;-->
    <!--var circle2;-->
    <!--var circleBorder = 4;-->

    <!--svgCanvas.call(d3.drag().on("start", initialPlod)-->
        <!--.on("drag", dragDraw)-->
        <!--.on("end", stopRendering));-->

    <!--//    svgCanvas.on("mousedown", sizeCircle);-->

    <!--function getRadius(cX, cY, perimeterX, perimeterY){-->
        <!--/**-->
         <!--* using circle equation-->
         <!--*-->
         <!--* r2 = (x2 - x1)^2 + (y2 - y1)^2-->
         <!--*/-->
        <!--return Math.sqrt(Math.pow((perimeterX - cX), 2) + Math.pow((perimeterY - cY),2));-->
    <!--}-->

    <!--//initial marking of the circle on the canvas-->
    <!--function initialPlod(){-->
        <!--point1 = d3.mouse(this);-->
        <!--container = svgCanvas.append("g");-->
        <!--circle = container.append("circle")-->
            <!--.attr("cx", point1[0])-->
            <!--.attr("cy", point1[1])-->
            <!--.attr("r", 0);-->

        <!--circle2 = container.append("circle")-->
            <!--.attr("cx", point1[0])-->
            <!--.attr("cy", point1[1])-->
            <!--.attr("r", 0);-->
    <!--}-->

    <!--//drag point to adjust radius and render circle-->
    <!--function dragDraw(){-->
        <!--point2 = d3.mouse(this);-->
        <!--circle = circle.attr("r", getRadius(point1[0], point1[1], point2[0], point2[1]));-->

        <!--var circle2Radius;-->

        <!--if (getRadius(point1[0], point1[1], point2[0], point2[1]) <= circleBorder){-->
            <!--circle2Radius = getRadius(point1[0], point1[1], point2[0], point2[1]);-->
        <!--}else{-->
            <!--circle2Radius = getRadius(point1[0], point1[1], point2[0], point2[1]) - circleBorder;-->
        <!--}-->

        <!--circle2 = circle2.attr("r", circle2Radius);-->
<!--//        return circle-->
    <!--}-->

    <!--function selectDrag(){-->
        <!--var mousing = d3.mouse(this);-->
        <!--var mousingX = mousing[0];-->
        <!--var mousingY = mousing[1];-->
<!--//        d3.select(this).attr("cx", mousingX).attr("cy",mousingY).attr("r", getRadius(cX, cY, mousingX, mousingY));-->
        <!--console.log( d3.select(this._groups));-->
        <!--d3.select(this._groups["0"]["0"].children).attr("cx", mousingX).attr("cy",mousingY);-->
    <!--}-->

    <!--function resizingCircle(){-->

    <!--}-->

    <!--function stopRendering(){-->
        <!--svgCanvas.call(d3.drag().on("start", null)-->
            <!--.on("drag", null)-->
            <!--.on("end", null));-->
        <!--container.call(d3.drag().on("drag", selectDrag));-->

        <!--container.on("mouseover", highlight)-->
            <!--.on("mouseout", unhighlight);-->

        <!--function highlight(){-->
            <!--d3.select(this).classed('circle-active', true);-->

<!--//            d3.selectAll(this)-->
<!--//                .transition()-->
<!--//                .duration(500)  // Set how long it takes-->
<!--//                .style("stroke-width", 5);-->
        <!--}-->

        <!--function unhighlight(){-->
            <!--d3.select(this).classed('circle-active', false);-->
        <!--}-->
    <!--}-->
<!--</script>-->
</body>
</html>